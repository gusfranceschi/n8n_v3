{"createdAt":"2025-06-02T14:43:07.895Z","updatedAt":"2025-06-02T14:48:08.555Z","id":"CNXMPJGNJQMJ0cFe","name":"12 - LIMPEZA AUTOMÁTICA","active":false,"isArchived":false,"nodes":[{"parameters":{"rule":{"interval":[{}]}},"type":"n8n-nodes-base.scheduleTrigger","typeVersion":1.2,"position":[0,0],"id":"6a8c6a3f-8b0c-4b6a-b2ff-d09fe7b14415","name":"Gatilho de Agendamento de Limpeza"},{"parameters":{"command":"sudo bash -lc 'command -v sqlite3 &>/dev/null || {    if command -v apt-get &>/dev/null; then      apt-get update -y && apt-get install -y sqlite3;    elif command -v yum &>/dev/null; then      yum install -y sqlite;    fi;  }'"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[220,0],"id":"7f35638f-fb20-4839-8525-0adacd28fd75","name":"Instalar SQLite3 se Necessário"},{"parameters":{"command":"sudo sqlite3 /etc/easypanel/projects/n8n/n8n/volumes/data/database.sqlite <<'EOF'\n-- mantém apenas as 1000 últimas execuções em execution_entity\nDELETE FROM execution_entity\nWHERE id NOT IN (\n  SELECT id FROM execution_entity\n  ORDER BY id DESC\n  LIMIT 1000\n);\n-- mantém apenas as 1000 últimas execuções em execution_data\nDELETE FROM execution_data\nWHERE executionId NOT IN (\n  SELECT executionId FROM execution_data\n  ORDER BY executionId DESC\n  LIMIT 1000\n);\nVACUUM;\nEOF\n"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[440,0],"id":"d633c124-1f0f-4818-b608-640c02b738cc","name":" Remover Execuções Antigas"},{"parameters":{"command":"bash -lc \"echo 'SELECT COUNT(*) FROM execution_data;' | sqlite3 /etc/easypanel/projects/n8n/n8n/volumes/data/database.sqlite\""},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[660,0],"id":"f02a6bdc-8c58-4eb6-b59f-e046ede1d6d1","name":"Contar Registros de Execução"},{"parameters":{"command":"sudo rm -rf /tmp/*"},"type":"n8n-nodes-base.ssh","typeVersion":1,"position":[880,0],"id":"478f01f0-7f3b-4ff5-b492-6d5131c7316f","name":"Remover Arquivos Temporários"}],"connections":{"Gatilho de Agendamento de Limpeza":{"main":[[{"node":"Instalar SQLite3 se Necessário","type":"main","index":0}]]},"Instalar SQLite3 se Necessário":{"main":[[{"node":" Remover Execuções Antigas","type":"main","index":0}]]}," Remover Execuções Antigas":{"main":[[{"node":"Contar Registros de Execução","type":"main","index":0}]]},"Contar Registros de Execução":{"main":[[{"node":"Remover Arquivos Temporários","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"20902adf-5530-4c5e-b37e-c714fdf0a468","triggerCount":0,"tags":[]}